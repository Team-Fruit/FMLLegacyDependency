language: java
jdk: oraclejdk8
branches:
  except:
    - /^build@.*/
install:
  - mvn clean install
cache:
  directories:
    - .autoconf
    - $HOME/.m2
notifications:
  email: false
  webhooks:
    urls:
      secure: "Wh1a4afsFv5RoqjLnqN+ikDx4tsn+0/2jTI7uCsYZ8moH2PLsOrwS0GTC29xccSE7K0ZuHVGJTl1ewV9HN9/B6tGdBG60FautB5bYL1ALkWNn9RC6Rg0OGC361Nr/dI8kA9X495ADr7FH1GTIhhV26t7Ncjs53gczyNeiDUpEj6VZyIokckaC+6V5b1npaddFaj80qKaqkcvQJzVu95mqzB/Il28A9CQ013Afnpo6RYT5scmv1/mFXFev1kVDxMqEclMpDxap3UR3roI11KsHFn7t4laXGKGlDraqR3kWtSvP+J/wrKj5nSkp11Lxf+qpgjpf6WaU8g64WWrmpdqxeJMVN4/niTiQvvyk+6gMO02l5vVUyhBNwGuYESHfOsu90r2Sek2kAyvgR/ccUWdSA5/w+pcZ8swkOs081S54W6+A3abFjyb2kMZTXWEhpvRw4VdkuK5FU/nG6VPqSHW/U+YXHWn245AgTBevGaH68aFrhvc6ENJ6NZCaKO3KZ8+oPHycRJhRZjM8gI8+3oUoER611kmG5d7TRqP7UI1LVkIOYD/czrq0XCC0K1vSMJbe1SdfAX/RMWKPJLrkiPAtxIdft5lAVU61H2ebPfO+ORrIVSnkNPPUWwVZ3bwEWwrlJyJK3oobCpSki7DdzephGlE6QzKifUG4iui3nboJFo="
before_deploy:
  - mvn package
  - git config --global user.email "builds@travis-ci.com"
  - git config --global user.name "Travis CI"
  - export GIT_TAG=build@${TRAVIS_BRANCH}#${TRAVIS_BUILD_NUMBER}
  - git tag ${GIT_TAG} -a -m "Generated tag from TravisCI build ${TRAVIS_BUILD_NUMBER}"
  - git push --quiet https://${GITHUB_TOKEN}@github.com/Team-Fruit/FMLLegacyDependency ${GIT_TAG} > /dev/null 2>&1
  - echo "Creating description file for bintray."
  - sh tools/travis_postbuild.sh
deploy:
  - provider: releases
    prerelease: true
    api_key: ${GITHUB_TOKEN}
    file_glob: true
    file: target/*.jar
    all_branches: true
    skip_cleanup: true
    on:
      tags: false
      condition: '! "$TRAVIS_BRANCH" =~ ^(dev\\-|feature\\/).*$'
  - provider: bintray
    file: ".bintray.json"
    user: "team-fruit"
    key:
      secure: "Gt3WrfxDYGwyFawp43NPvYmtBgPyOcXVOrulXvTzjZcEfPfVJrRfLVbBdx/bKkkKpo+qz0gUtTdTZ2CYsUTxnQvph99MCysvt4bi7msAWJ9a24+Xtuav9MTTAYRE9nxHoPxdQLi42RxYtq4+TOUGW9ehu3ZXUaSIAyT7lfqgsMQtR/YbAUT8w0PSgdYPILoWPxLTC2ocZl0FmZFU2TjZ1mVSMJI3uBGtdQNaGY0LXDojjcWWBp9Wawf60NaR3B5Lkm083+krU/vqvqM0Ic4FWY/wYCnUIZf8TJnnx00gdR7NegdZzbh+ikY6/3q8LeAEzthA6Sk2zhP+QH7PS5QVk32r46j7TO+Mqme4KNBEh+4c6cxSXJV9oYDOUA8dR6NzUJzC3jH8BRIAamCzlxA2iBbD8CEY1dz7uQlcfCGxp93Piq1eOIv8/q9tt+vRRpFI5dKTBlabGnxgEXxQNj0Tw2WXt1YLAyMDiPV/+6uz4MI4Tsp4HmJsHzx0ov7pxJ9GSe97p4tCWZixyfREURSeikhUh/JAt/F2WSSV04Qt1uT34sLaVRG3XTWQFjkjW11mE/dyFpTE9DEVtmD6pr/07tm+QY5vwBh29wnAx+3wRw/F7HrYamiQ6QTiYz8inWGRaAeq1IDjmVfj2kmejbr2QY76xE7BGoH9DShXdMowfEI="
    all_branches: true
    skip_cleanup: true
    on:
      tags: true
